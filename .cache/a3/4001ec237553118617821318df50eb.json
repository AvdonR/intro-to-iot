{"id":"IUlR","dependencies":[{"name":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\package.json","includedInParent":true,"mtime":1607041298567},{"name":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\node_modules\\mqtt\\package.json","includedInParent":true,"mtime":1607041298390},{"name":"readable-stream","loc":{"line":3,"column":24},"parent":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\node_modules\\mqtt\\lib\\connect\\wx.js","resolved":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\node_modules\\mqtt\\node_modules\\readable-stream\\readable-browser.js"},{"name":"duplexify","loc":{"line":4,"column":24},"parent":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\node_modules\\mqtt\\lib\\connect\\wx.js","resolved":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\node_modules\\duplexify\\index.js"},{"name":"buffer","parent":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\node_modules\\mqtt\\lib\\connect\\wx.js","resolved":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\node_modules\\buffer\\index.js"},{"name":"process","parent":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\node_modules\\mqtt\\lib\\connect\\wx.js","resolved":"C:\\Users\\danny\\Documents\\gitRoot\\intro-to-iot\\node_modules\\process\\browser.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar process = require(\"process\");\nvar o,t,r,n=require(\"buffer\").Buffer,e=require(\"process\"),s=require(\"readable-stream\").Transform,c=require(\"duplexify\");function f(){var t=new s;return t._write=function(t,r,n){o.send({data:t.buffer,success:function(){n()},fail:function(o){n(new Error(o))}})},t._flush=function(t){o.close({success:function(){t()}})},t}function u(o){o.hostname||(o.hostname=\"localhost\"),o.path||(o.path=\"/\"),o.wsOptions||(o.wsOptions={})}function a(o,t){var r=\"wxs\"===o.protocol?\"wss\":\"ws\",n=r+\"://\"+o.hostname+o.path;return o.port&&80!==o.port&&443!==o.port&&(n=r+\"://\"+o.hostname+\":\"+o.port+o.path),\"function\"==typeof o.transformWsUrl&&(n=o.transformWsUrl(n,o,t)),n}function i(){o.onOpen(function(){r.setReadable(t),r.setWritable(t),r.emit(\"connect\")}),o.onMessage(function(o){var r=o.data;r=r instanceof ArrayBuffer?n.from(r):n.from(r,\"utf8\"),t.push(r)}),o.onClose(function(){r.end(),r.destroy()}),o.onError(function(o){r.destroy(new Error(o.errMsg))})}function l(n,s){if(s.hostname=s.hostname||s.host,!s.hostname)throw new Error(\"Could not determine host. Specify host manually.\");var l=\"MQIsdp\"===s.protocolId&&3===s.protocolVersion?\"mqttv3.1\":\"mqtt\";u(s);var p=a(s,n);o=wx.connectSocket({url:p,protocols:l}),t=f(),(r=c.obj())._destroy=function(t,r){o.close({success:function(){r&&r(t)}})};var d=r.destroy;return r.destroy=function(){r.destroy=d;var t=this;e.nextTick(function(){o.close({fail:function(){t._destroy(new Error)}})})}.bind(r),i(),r}module.exports=l;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":134,"column":0},"generated":{"line":3,"column":0}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":7,"column":4},"generated":{"line":3,"column":4}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":8,"column":4},"generated":{"line":3,"column":6}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":9,"column":4},"generated":{"line":3,"column":8}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":134,"column":0},"generated":{"line":3,"column":10}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":134,"column":0},"generated":{"line":3,"column":12}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":134,"column":0},"generated":{"line":3,"column":20}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":134,"column":0},"generated":{"line":3,"column":30}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":134,"column":0},"generated":{"line":3,"column":37}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":134,"column":0},"generated":{"line":3,"column":39}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":134,"column":0},"generated":{"line":3,"column":47}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"Transform","original":{"line":3,"column":4},"generated":{"line":3,"column":58}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"require","original":{"line":3,"column":16},"generated":{"line":3,"column":60}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":3,"column":24},"generated":{"line":3,"column":68}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"Transform","original":{"line":3,"column":43},"generated":{"line":3,"column":87}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"duplexify","original":{"line":4,"column":4},"generated":{"line":3,"column":97}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"require","original":{"line":4,"column":16},"generated":{"line":3,"column":99}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":4,"column":24},"generated":{"line":3,"column":107}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":11,"column":0},"generated":{"line":3,"column":120}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"buildProxy","original":{"line":11,"column":9},"generated":{"line":3,"column":129}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":12,"column":6},"generated":{"line":3,"column":133}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":12,"column":6},"generated":{"line":3,"column":137}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":12,"column":14},"generated":{"line":3,"column":139}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"Transform","original":{"line":12,"column":18},"generated":{"line":3,"column":143}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":32,"column":9},"generated":{"line":3,"column":145}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":13,"column":2},"generated":{"line":3,"column":152}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"_write","original":{"line":13,"column":8},"generated":{"line":3,"column":154}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":13,"column":17},"generated":{"line":3,"column":161}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"chunk","original":{"line":13,"column":27},"generated":{"line":3,"column":170}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"encoding","original":{"line":13,"column":34},"generated":{"line":3,"column":172}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"next","original":{"line":13,"column":44},"generated":{"line":3,"column":174}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":14,"column":4},"generated":{"line":3,"column":177}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"send","original":{"line":14,"column":15},"generated":{"line":3,"column":179}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":14,"column":20},"generated":{"line":3,"column":184}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"data","original":{"line":15,"column":6},"generated":{"line":3,"column":185}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"chunk","original":{"line":15,"column":12},"generated":{"line":3,"column":190}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"buffer","original":{"line":15,"column":18},"generated":{"line":3,"column":192}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"success","original":{"line":16,"column":6},"generated":{"line":3,"column":199}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":16,"column":15},"generated":{"line":3,"column":207}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"next","original":{"line":17,"column":8},"generated":{"line":3,"column":218}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"fail","original":{"line":19,"column":6},"generated":{"line":3,"column":223}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":19,"column":12},"generated":{"line":3,"column":228}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"errMsg","original":{"line":19,"column":22},"generated":{"line":3,"column":237}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"next","original":{"line":20,"column":8},"generated":{"line":3,"column":240}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":20,"column":13},"generated":{"line":3,"column":242}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"Error","original":{"line":20,"column":17},"generated":{"line":3,"column":246}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"errMsg","original":{"line":20,"column":23},"generated":{"line":3,"column":252}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":24,"column":2},"generated":{"line":3,"column":260}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"_flush","original":{"line":24,"column":8},"generated":{"line":3,"column":262}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":24,"column":17},"generated":{"line":3,"column":269}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"done","original":{"line":24,"column":37},"generated":{"line":3,"column":278}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":25,"column":4},"generated":{"line":3,"column":281}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"close","original":{"line":25,"column":15},"generated":{"line":3,"column":283}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":25,"column":21},"generated":{"line":3,"column":289}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"success","original":{"line":26,"column":6},"generated":{"line":3,"column":290}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":26,"column":15},"generated":{"line":3,"column":298}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"done","original":{"line":27,"column":8},"generated":{"line":3,"column":309}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":32,"column":9},"generated":{"line":3,"column":317}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":35,"column":0},"generated":{"line":3,"column":319}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"setDefaultOpts","original":{"line":35,"column":9},"generated":{"line":3,"column":328}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":35,"column":25},"generated":{"line":3,"column":330}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":36,"column":7},"generated":{"line":3,"column":333}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"hostname","original":{"line":36,"column":12},"generated":{"line":3,"column":335}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":37,"column":4},"generated":{"line":3,"column":346}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"hostname","original":{"line":37,"column":9},"generated":{"line":3,"column":348}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":37,"column":20},"generated":{"line":3,"column":357}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":39,"column":7},"generated":{"line":3,"column":370}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"path","original":{"line":39,"column":12},"generated":{"line":3,"column":372}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":40,"column":4},"generated":{"line":3,"column":379}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"path","original":{"line":40,"column":9},"generated":{"line":3,"column":381}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":40,"column":16},"generated":{"line":3,"column":386}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":43,"column":7},"generated":{"line":3,"column":391}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"wsOptions","original":{"line":43,"column":12},"generated":{"line":3,"column":393}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":44,"column":4},"generated":{"line":3,"column":405}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"wsOptions","original":{"line":44,"column":9},"generated":{"line":3,"column":407}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":44,"column":21},"generated":{"line":3,"column":417}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":48,"column":0},"generated":{"line":3,"column":421}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"buildUrl","original":{"line":48,"column":9},"generated":{"line":3,"column":430}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":48,"column":19},"generated":{"line":3,"column":432}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"client","original":{"line":48,"column":25},"generated":{"line":3,"column":434}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"protocol","original":{"line":49,"column":6},"generated":{"line":3,"column":437}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"protocol","original":{"line":49,"column":6},"generated":{"line":3,"column":441}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":49,"column":35},"generated":{"line":3,"column":443}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":49,"column":17},"generated":{"line":3,"column":451}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"protocol","original":{"line":49,"column":22},"generated":{"line":3,"column":453}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":49,"column":43},"generated":{"line":3,"column":462}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":49,"column":51},"generated":{"line":3,"column":468}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":50,"column":6},"generated":{"line":3,"column":473}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"protocol","original":{"line":50,"column":12},"generated":{"line":3,"column":475}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":50,"column":23},"generated":{"line":3,"column":477}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":50,"column":31},"generated":{"line":3,"column":483}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"hostname","original":{"line":50,"column":36},"generated":{"line":3,"column":485}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":50,"column":47},"generated":{"line":3,"column":494}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"path","original":{"line":50,"column":52},"generated":{"line":3,"column":496}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":57,"column":9},"generated":{"line":3,"column":501}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":51,"column":6},"generated":{"line":3,"column":508}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"port","original":{"line":51,"column":11},"generated":{"line":3,"column":510}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":51,"column":33},"generated":{"line":3,"column":516}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":51,"column":19},"generated":{"line":3,"column":521}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"port","original":{"line":51,"column":24},"generated":{"line":3,"column":523}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":51,"column":53},"generated":{"line":3,"column":529}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":51,"column":39},"generated":{"line":3,"column":535}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"port","original":{"line":51,"column":44},"generated":{"line":3,"column":537}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":52,"column":4},"generated":{"line":3,"column":544}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"protocol","original":{"line":52,"column":10},"generated":{"line":3,"column":546}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":52,"column":21},"generated":{"line":3,"column":548}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":52,"column":29},"generated":{"line":3,"column":554}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"hostname","original":{"line":52,"column":34},"generated":{"line":3,"column":556}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":52,"column":45},"generated":{"line":3,"column":565}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":52,"column":51},"generated":{"line":3,"column":569}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"port","original":{"line":52,"column":56},"generated":{"line":3,"column":571}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":52,"column":63},"generated":{"line":3,"column":576}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"path","original":{"line":52,"column":68},"generated":{"line":3,"column":578}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":54,"column":39},"generated":{"line":3,"column":584}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":54,"column":14},"generated":{"line":3,"column":603}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"transformWsUrl","original":{"line":54,"column":19},"generated":{"line":3,"column":605}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":55,"column":4},"generated":{"line":3,"column":622}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":55,"column":10},"generated":{"line":3,"column":624}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"transformWsUrl","original":{"line":55,"column":15},"generated":{"line":3,"column":626}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":55,"column":30},"generated":{"line":3,"column":641}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":55,"column":35},"generated":{"line":3,"column":643}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"client","original":{"line":55,"column":41},"generated":{"line":3,"column":645}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":57,"column":9},"generated":{"line":3,"column":649}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":60,"column":0},"generated":{"line":3,"column":651}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"bindEventHandler","original":{"line":60,"column":9},"generated":{"line":3,"column":660}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":61,"column":2},"generated":{"line":3,"column":664}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"onOpen","original":{"line":61,"column":13},"generated":{"line":3,"column":666}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":61,"column":20},"generated":{"line":3,"column":673}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":62,"column":4},"generated":{"line":3,"column":684}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"setReadable","original":{"line":62,"column":11},"generated":{"line":3,"column":686}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":62,"column":23},"generated":{"line":3,"column":698}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":63,"column":4},"generated":{"line":3,"column":701}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"setWritable","original":{"line":63,"column":11},"generated":{"line":3,"column":703}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":63,"column":23},"generated":{"line":3,"column":715}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":64,"column":4},"generated":{"line":3,"column":718}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"emit","original":{"line":64,"column":11},"generated":{"line":3,"column":720}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":64,"column":16},"generated":{"line":3,"column":725}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":67,"column":2},"generated":{"line":3,"column":738}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"onMessage","original":{"line":67,"column":13},"generated":{"line":3,"column":740}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":67,"column":23},"generated":{"line":3,"column":750}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"res","original":{"line":67,"column":33},"generated":{"line":3,"column":759}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"data","original":{"line":68,"column":8},"generated":{"line":3,"column":762}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"data","original":{"line":68,"column":8},"generated":{"line":3,"column":766}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"res","original":{"line":68,"column":15},"generated":{"line":3,"column":768}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"data","original":{"line":68,"column":19},"generated":{"line":3,"column":770}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"data","original":{"line":70,"column":37},"generated":{"line":3,"column":775}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"data","original":{"line":70,"column":8},"generated":{"line":3,"column":777}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"ArrayBuffer","original":{"line":70,"column":24},"generated":{"line":3,"column":790}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"Buffer","original":{"line":70,"column":44},"generated":{"line":3,"column":802}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"from","original":{"line":70,"column":51},"generated":{"line":3,"column":804}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"data","original":{"line":70,"column":56},"generated":{"line":3,"column":809}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"Buffer","original":{"line":71,"column":16},"generated":{"line":3,"column":812}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"from","original":{"line":71,"column":23},"generated":{"line":3,"column":814}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"data","original":{"line":71,"column":28},"generated":{"line":3,"column":819}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":71,"column":34},"generated":{"line":3,"column":821}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":72,"column":4},"generated":{"line":3,"column":829}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"push","original":{"line":72,"column":10},"generated":{"line":3,"column":831}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"data","original":{"line":72,"column":15},"generated":{"line":3,"column":836}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":75,"column":2},"generated":{"line":3,"column":841}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"onClose","original":{"line":75,"column":13},"generated":{"line":3,"column":843}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":75,"column":21},"generated":{"line":3,"column":851}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":76,"column":4},"generated":{"line":3,"column":862}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"end","original":{"line":76,"column":11},"generated":{"line":3,"column":864}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":77,"column":4},"generated":{"line":3,"column":870}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"destroy","original":{"line":77,"column":11},"generated":{"line":3,"column":872}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":80,"column":2},"generated":{"line":3,"column":884}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"onError","original":{"line":80,"column":13},"generated":{"line":3,"column":886}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":80,"column":21},"generated":{"line":3,"column":894}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"res","original":{"line":80,"column":31},"generated":{"line":3,"column":903}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":81,"column":4},"generated":{"line":3,"column":906}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"destroy","original":{"line":81,"column":11},"generated":{"line":3,"column":908}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":81,"column":19},"generated":{"line":3,"column":916}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"Error","original":{"line":81,"column":23},"generated":{"line":3,"column":920}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"res","original":{"line":81,"column":29},"generated":{"line":3,"column":926}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"errMsg","original":{"line":81,"column":33},"generated":{"line":3,"column":928}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":85,"column":0},"generated":{"line":3,"column":939}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"buildStream","original":{"line":85,"column":9},"generated":{"line":3,"column":948}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"client","original":{"line":85,"column":22},"generated":{"line":3,"column":950}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":85,"column":30},"generated":{"line":3,"column":952}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":88,"column":6},"generated":{"line":3,"column":955}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":86,"column":2},"generated":{"line":3,"column":958}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"hostname","original":{"line":86,"column":7},"generated":{"line":3,"column":960}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":86,"column":18},"generated":{"line":3,"column":969}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"hostname","original":{"line":86,"column":23},"generated":{"line":3,"column":971}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":86,"column":35},"generated":{"line":3,"column":981}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"host","original":{"line":86,"column":40},"generated":{"line":3,"column":983}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":88,"column":7},"generated":{"line":3,"column":989}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"hostname","original":{"line":88,"column":12},"generated":{"line":3,"column":991}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":89,"column":10},"generated":{"line":3,"column":1000}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":89,"column":10},"generated":{"line":3,"column":1006}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"Error","original":{"line":89,"column":14},"generated":{"line":3,"column":1010}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":89,"column":20},"generated":{"line":3,"column":1016}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"websocketSubProtocol","original":{"line":92,"column":6},"generated":{"line":3,"column":1068}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"websocketSubProtocol","original":{"line":92,"column":6},"generated":{"line":3,"column":1072}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":93,"column":25},"generated":{"line":3,"column":1074}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":93,"column":5},"generated":{"line":3,"column":1085}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"protocolId","original":{"line":93,"column":10},"generated":{"line":3,"column":1087}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":93,"column":64},"generated":{"line":3,"column":1099}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":93,"column":39},"generated":{"line":3,"column":1103}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"protocolVersion","original":{"line":93,"column":44},"generated":{"line":3,"column":1105}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":94,"column":8},"generated":{"line":3,"column":1121}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":95,"column":8},"generated":{"line":3,"column":1132}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"setDefaultOpts","original":{"line":97,"column":2},"generated":{"line":3,"column":1139}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":97,"column":17},"generated":{"line":3,"column":1141}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":99,"column":6},"generated":{"line":3,"column":1144}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":99,"column":6},"generated":{"line":3,"column":1148}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"buildUrl","original":{"line":99,"column":12},"generated":{"line":3,"column":1150}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"opts","original":{"line":99,"column":21},"generated":{"line":3,"column":1152}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"client","original":{"line":99,"column":27},"generated":{"line":3,"column":1154}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":100,"column":2},"generated":{"line":3,"column":1157}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"wx","original":{"line":100,"column":15},"generated":{"line":3,"column":1159}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"connectSocket","original":{"line":100,"column":18},"generated":{"line":3,"column":1162}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":100,"column":32},"generated":{"line":3,"column":1176}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":101,"column":4},"generated":{"line":3,"column":1177}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"url","original":{"line":101,"column":9},"generated":{"line":3,"column":1181}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"protocols","original":{"line":102,"column":4},"generated":{"line":3,"column":1183}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"websocketSubProtocol","original":{"line":102,"column":15},"generated":{"line":3,"column":1193}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"proxy","original":{"line":105,"column":2},"generated":{"line":3,"column":1197}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"buildProxy","original":{"line":105,"column":10},"generated":{"line":3,"column":1199}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":106,"column":2},"generated":{"line":3,"column":1204}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"duplexify","original":{"line":106,"column":11},"generated":{"line":3,"column":1206}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"obj","original":{"line":106,"column":21},"generated":{"line":3,"column":1208}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"_destroy","original":{"line":107,"column":9},"generated":{"line":3,"column":1215}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":107,"column":20},"generated":{"line":3,"column":1224}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"err","original":{"line":107,"column":30},"generated":{"line":3,"column":1233}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"cb","original":{"line":107,"column":35},"generated":{"line":3,"column":1235}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":108,"column":4},"generated":{"line":3,"column":1238}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"close","original":{"line":108,"column":15},"generated":{"line":3,"column":1240}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":108,"column":21},"generated":{"line":3,"column":1246}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"success","original":{"line":109,"column":6},"generated":{"line":3,"column":1247}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":109,"column":15},"generated":{"line":3,"column":1255}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"cb","original":{"line":110,"column":8},"generated":{"line":3,"column":1266}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"cb","original":{"line":110,"column":14},"generated":{"line":3,"column":1269}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"err","original":{"line":110,"column":17},"generated":{"line":3,"column":1271}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"destroyRef","original":{"line":115,"column":6},"generated":{"line":3,"column":1278}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"destroyRef","original":{"line":115,"column":6},"generated":{"line":3,"column":1282}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":115,"column":19},"generated":{"line":3,"column":1284}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"destroy","original":{"line":115,"column":26},"generated":{"line":3,"column":1286}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":131,"column":9},"generated":{"line":3,"column":1294}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":116,"column":2},"generated":{"line":3,"column":1301}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"destroy","original":{"line":116,"column":9},"generated":{"line":3,"column":1303}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":116,"column":19},"generated":{"line":3,"column":1311}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":117,"column":4},"generated":{"line":3,"column":1322}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"destroy","original":{"line":117,"column":11},"generated":{"line":3,"column":1324}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"destroyRef","original":{"line":117,"column":21},"generated":{"line":3,"column":1332}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"self","original":{"line":119,"column":8},"generated":{"line":3,"column":1334}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"self","original":{"line":119,"column":8},"generated":{"line":3,"column":1338}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":119,"column":15},"generated":{"line":3,"column":1340}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"process","original":{"line":120,"column":4},"generated":{"line":3,"column":1345}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"nextTick","original":{"line":120,"column":12},"generated":{"line":3,"column":1347}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":120,"column":21},"generated":{"line":3,"column":1356}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"socketTask","original":{"line":121,"column":6},"generated":{"line":3,"column":1367}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"close","original":{"line":121,"column":17},"generated":{"line":3,"column":1369}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":121,"column":23},"generated":{"line":3,"column":1375}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"fail","original":{"line":122,"column":8},"generated":{"line":3,"column":1376}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":122,"column":14},"generated":{"line":3,"column":1381}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"self","original":{"line":123,"column":10},"generated":{"line":3,"column":1392}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"_destroy","original":{"line":123,"column":15},"generated":{"line":3,"column":1394}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","original":{"line":123,"column":24},"generated":{"line":3,"column":1403}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"Error","original":{"line":123,"column":28},"generated":{"line":3,"column":1407}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"bind","original":{"line":127,"column":4},"generated":{"line":3,"column":1420}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":127,"column":9},"generated":{"line":3,"column":1425}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"bindEventHandler","original":{"line":129,"column":2},"generated":{"line":3,"column":1428}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"stream","original":{"line":131,"column":9},"generated":{"line":3,"column":1432}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"module","original":{"line":134,"column":0},"generated":{"line":3,"column":1434}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"exports","original":{"line":134,"column":7},"generated":{"line":3,"column":1441}},{"source":"../../../node_modules/mqtt/lib/connect/wx.js","name":"buildStream","original":{"line":134,"column":17},"generated":{"line":3,"column":1449}}],"sources":{"../../../node_modules/mqtt/lib/connect/wx.js":"'use strict'\r\n\r\nvar Transform = require('readable-stream').Transform\r\nvar duplexify = require('duplexify')\r\n\r\n/* global wx */\r\nvar socketTask\r\nvar proxy\r\nvar stream\r\n\r\nfunction buildProxy () {\r\n  var proxy = new Transform()\r\n  proxy._write = function (chunk, encoding, next) {\r\n    socketTask.send({\r\n      data: chunk.buffer,\r\n      success: function () {\r\n        next()\r\n      },\r\n      fail: function (errMsg) {\r\n        next(new Error(errMsg))\r\n      }\r\n    })\r\n  }\r\n  proxy._flush = function socketEnd (done) {\r\n    socketTask.close({\r\n      success: function () {\r\n        done()\r\n      }\r\n    })\r\n  }\r\n\r\n  return proxy\r\n}\r\n\r\nfunction setDefaultOpts (opts) {\r\n  if (!opts.hostname) {\r\n    opts.hostname = 'localhost'\r\n  }\r\n  if (!opts.path) {\r\n    opts.path = '/'\r\n  }\r\n\r\n  if (!opts.wsOptions) {\r\n    opts.wsOptions = {}\r\n  }\r\n}\r\n\r\nfunction buildUrl (opts, client) {\r\n  var protocol = opts.protocol === 'wxs' ? 'wss' : 'ws'\r\n  var url = protocol + '://' + opts.hostname + opts.path\r\n  if (opts.port && opts.port !== 80 && opts.port !== 443) {\r\n    url = protocol + '://' + opts.hostname + ':' + opts.port + opts.path\r\n  }\r\n  if (typeof (opts.transformWsUrl) === 'function') {\r\n    url = opts.transformWsUrl(url, opts, client)\r\n  }\r\n  return url\r\n}\r\n\r\nfunction bindEventHandler () {\r\n  socketTask.onOpen(function () {\r\n    stream.setReadable(proxy)\r\n    stream.setWritable(proxy)\r\n    stream.emit('connect')\r\n  })\r\n\r\n  socketTask.onMessage(function (res) {\r\n    var data = res.data\r\n\r\n    if (data instanceof ArrayBuffer) data = Buffer.from(data)\r\n    else data = Buffer.from(data, 'utf8')\r\n    proxy.push(data)\r\n  })\r\n\r\n  socketTask.onClose(function () {\r\n    stream.end()\r\n    stream.destroy()\r\n  })\r\n\r\n  socketTask.onError(function (res) {\r\n    stream.destroy(new Error(res.errMsg))\r\n  })\r\n}\r\n\r\nfunction buildStream (client, opts) {\r\n  opts.hostname = opts.hostname || opts.host\r\n\r\n  if (!opts.hostname) {\r\n    throw new Error('Could not determine host. Specify host manually.')\r\n  }\r\n\r\n  var websocketSubProtocol =\r\n    (opts.protocolId === 'MQIsdp') && (opts.protocolVersion === 3)\r\n      ? 'mqttv3.1'\r\n      : 'mqtt'\r\n\r\n  setDefaultOpts(opts)\r\n\r\n  var url = buildUrl(opts, client)\r\n  socketTask = wx.connectSocket({\r\n    url: url,\r\n    protocols: websocketSubProtocol\r\n  })\r\n\r\n  proxy = buildProxy()\r\n  stream = duplexify.obj()\r\n  stream._destroy = function (err, cb) {\r\n    socketTask.close({\r\n      success: function () {\r\n        cb && cb(err)\r\n      }\r\n    })\r\n  }\r\n\r\n  var destroyRef = stream.destroy\r\n  stream.destroy = function () {\r\n    stream.destroy = destroyRef\r\n\r\n    var self = this\r\n    process.nextTick(function () {\r\n      socketTask.close({\r\n        fail: function () {\r\n          self._destroy(new Error())\r\n        }\r\n      })\r\n    })\r\n  }.bind(stream)\r\n\r\n  bindEventHandler()\r\n\r\n  return stream\r\n}\r\n\r\nmodule.exports = buildStream\r\n"},"lineCount":null}},"error":null,"hash":"84d4aec9f8a2dd68132540c4a6ddfb14","cacheData":{"env":{}}}